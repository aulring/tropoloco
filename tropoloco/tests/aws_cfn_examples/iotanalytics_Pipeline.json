{"Type": "AWS::IoTAnalytics::Pipeline", "Properties": {"PipelineName": "ComplexPipeline", "PipelineActivities": [{"Channel": {"Name": "ChannelActivity", "ChannelName": "Channel", "Next": "LambdaActivity"}, "Lambda": {"Name": "LambdaActivity", "LambdaName": "Lambda", "BatchSize": 1, "Next": "AddAttributesActivity"}, "AddAttributes": {"Name": "AddAttributesActivity", "Attributes": {"key1": "attribute1", "key2": "attribute2"}, "Next": "RemoveAttributesActivity"}, "RemoveAttributes": {"Name": "RemoveAttributesActivity", "Attributes": ["attribute1", "attribute2"], "Next": "SelectAttributesActivity"}, "SelectAttributes": {"Name": "SelectAttributesActivity", "Attributes": ["attribute1", "attribute2"], "Next": "FilterActivity"}, "Filter": {"Name": "FilterActivity", "Filter": "attribute1 > 40 AND attribute2 < 20", "Next": "MathActivity"}, "Math": {"Name": "MathActivity", "Attribute": "attribute", "Math": "attribute - 10", "Next": "DeviceRegistryEnrichActivity"}, "DeviceRegistryEnrich": {"Name": "DeviceRegistryEnrichActivity", "Attribute": "attribute", "ThingName": "thingName", "RoleArn": "arn:aws:iam::<your_Account_Id>:role/Enrich", "Next": "DeviceShadowEnrichActivity"}, "DeviceShadowEnrich": {"Name": "DeviceShadowEnrichActivity", "Attribute": "attribute", "ThingName": "thingName", "RoleArn": "arn:aws:iam::<your_Account_Id>:role/Enrich", "Next": "DatastoreActivity"}, "Datastore": {"Name": "DatastoreActivity", "DatastoreName": "Datastore"}}]}}